---
title: "wholePlotTrajectories_manuscript"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# POST-DISTURBANCE DIVERSITY TRAJECTORIES IN A NEOTROPICAL FOREST
\
\
\


## Summary
\
\
\
\


## Introduction
\
\
\
\


## Material and Methods
\
\


### Study site
\
\


### Inventories protocol and dataset correction

\
\


### Composition and diversity metrics

\
\



##Results

Over time, 104423 trees and 697 botanical species were recorded. The disturbance proved to significantly impact for more than 30 years the functional and taxonomic composition and diversity of the stands. 

### Taxonomic and functional composition

*Composition trajectories* _ Trajectories of taxonomic and functional composition after disturbance were examined through the ordination of successive inventories from 1989 (5 years after disturbance) in a two-dimensional space based on NMDS analysis. Classifications were based on either abundance-based Bray-Curtis (Fig. 1) or incidence-based Jaccard dissimilarity (data not shown).

Both taxonomic and functional composition were substantially affected by disturbance and positively correlated with its intensity. *The distance from the initial condition was significantly time-dependent (P<0.01).* The taxonomic composition remained significantly different from the 1989 inventory until 30 years for all disturbed plots (Fig. 2a). The distancing was positively correlated woth disturbance intensity. From 20 years after disturbance though the distancing reduced, suggesting the beginning of a return toward the reference 1989 inventory (Fig. 1a & 2a). The functional composition distancing from 1989 was also positively correlated with disturbance intensity and similarly stabilized and reduced for 5 of T1, T2 and T3 plots from 20 years after disturbance (Fig. 2a). *The coordinates of the functional traits were measured in the two-dimensional ordination space that mapped plots evolution along time (graphs not showed) which revealed that the trajectories of disturbed plots along time headed toward acquisitive functional strategies (from high SWG to high SLA and chlorophyll content).*

```{r pressure, echo=FALSE,fig.cap="Fig. 2"}
treatments<-list(c(1,6,11),c(2,7,9),c(3,5,10),c(4,8,12))
names(treatments)<-c("Control","T1","T2","T3")
load("FunctionalComposition_forGraph")
ColorsTr<-c("darkolivegreen2","deepskyblue2","darkorange1","red2")

par(mfrow=c(1,2))

Matrep<-lapply(Matrep,function(Rep){
  Rep<-as.data.frame(Rep)
  Rep$plot<-substr(rownames(Rep),start=1,stop=regexpr("_",rownames(Rep))-1)
  Rep$year<-substr(rownames(Rep),start=regexpr("_",rownames(Rep))+1,
                   stop=nchar(rownames(Rep)))
  return(Rep)
})

Dist<-lapply(1:12,function(pl){
  ret<-lapply(Matrep,function(rep){return(rep[which(rep[,"plot"]==pl),])})
  ret<-lapply(ret,function(rep){return(rep[which(rep[,"year"]%in%ret[[1]][,"year"]),])})
  ret<-do.call(rbind,lapply(ret,function(rep){
    ret2<-apply(rep[,c("NMDS1","NMDS2")],1,function(li){
    return(sqrt(sum((rep[1,c("NMDS1","NMDS2")]-li)^2)))})
    names(ret2)<-rep[,"year"]
    return(ret2)}))
  ret<-do.call(rbind,lapply(c(0.025,0.5,0.975),function(quant){
    return(apply(ret,2,function(col){return(quantile(col,probs=quant))}))}))
  rownames(ret)<-c(0.025,0.5,0.975)
  return(ret)})
names(Dist)<-1:12
Dist<-lapply(Dist,function(pl){
  colnames(pl)<-as.numeric(colnames(pl))-1984;return(pl)})

plot(colnames(Dist[[1]]),Dist[[1]][1,],type="n",xlab="",ylab="",
     ylim=c(min(unlist(Dist)),max(unlist(Dist))),cex.axis=0.7)
invisible(lapply(1:length(treatments),function(tr){
  toplot<-Dist[treatments[[tr]]]
  invisible(lapply(toplot,function(pl){
    lines(colnames(pl),pl["0.5",],col=ColorsTr[[tr]],lwd=2)
    polygon(c(colnames(pl),rev(colnames(pl))),c(pl["0.025",],rev(pl["0.975",])),
            col=rgb(0,0,0,alpha=0.1),border=NA)
  }))}))
mtext("Euclidean distance from 1989 inventory",side=2,padj=0,line=2,cex=0.8)
mtext("(a) Taxonomic composition",side=3,adj=0,line=0.5)


```




```{r cars}
summary(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
